package com.allen.web.service.company;

import java.util.Date;
import java.util.List;
import java.util.UUID;

import javax.annotation.Resource;

import org.apache.commons.collections.ListUtils;
import org.springframework.stereotype.Service;

import com.allen.core.feature.orm.mybatis.Page;
import com.allen.core.generic.GenericDao;
import com.allen.core.generic.GenericServiceImpl;
import com.allen.web.dao.CompanyActivityMapper;
import com.allen.web.enums.EnumBool;
import com.allen.web.model.Company;
import com.allen.web.model.CompanyActivity;
import com.allen.web.model.CompanyActivityExample;

@Service
public class CompanyActivityIServiceImpl extends GenericServiceImpl<CompanyActivity, String> implements CompanyActivityService{

	@Resource
	CompanyActivityMapper companyActivityMapper;
	
	@Override
	public GenericDao<CompanyActivity, String> getDao() {
		return this.companyActivityMapper;
	}

	
	public List<CompanyActivity> selectActivityBycompanyId(String companyId) {
		CompanyActivityExample companyActivityExample = new CompanyActivityExample();
		companyActivityExample.createCriteria().andCompanyIdEqualTo(companyId);		
		companyActivityExample.setOrderByClause("create_time desc");
		
		List<CompanyActivity>  calist = this.companyActivityMapper.selectByExample(companyActivityExample);
		if (calist.isEmpty()) {
			return ListUtils.EMPTY_LIST;
		}
		return calist;
	}

	@Override
	public int saveCompanyActivity(List<CompanyActivity> activityList) {
		String companyId = activityList.get(0).getCompanyId();
		CompanyActivityExample example = new CompanyActivityExample();
		example.createCriteria().andCompanyIdEqualTo(companyId);
		this.companyActivityMapper.deleteByExample(example);
		int i=0;
		for(CompanyActivity companyActivity:activityList)
		{
			companyActivity.setCreateTime(new Date());
			companyActivity.setIsvalid(EnumBool.YES.getCode());
			companyActivity.setId(UUID.randomUUID().toString());
			i = this.companyActivityMapper.insert(companyActivity);
		}
		return i;
	}


}
